{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h4>📘 강의자료 업로드</h4>
  <p>교수님은 강의자료를 업로드·수정·삭제할 수 있습니다.</p>

  <form method="POST" enctype="multipart/form-data" class="mt-3" id="uploadForm">
    <div class="mb-3">
      <label>① 내용(Topic)</label>
      <input type="text" name="topic" value="{{ edit_data['내용(Topic)'] if edit_data else '' }}" required style="width:100%;padding:6px;">
    </div>

    <div class="mb-3">
      <label>② 자료파일 URL</label>
      <input type="text" name="file_upload" value="{{ edit_data['자료파일(File URL)'] if edit_data else '' }}" placeholder="https://..." style="width:100%;padding:6px;">
    </div>

    <div class="mb-3">
      <label>③ 연관 사이트 (Google Drive, 뉴스 등)</label>
      <input type="text" name="related_site" value="{{ edit_data['연관사이트(Related Site)'] if edit_data else '' }}" placeholder="https://..." style="width:100%;padding:6px;">
    </div>

    <div class="mb-3">
      <label>④ 비고(Notes)</label>
      <input type="text" name="notes" value="{{ edit_data['비고(Notes)'] if edit_data else '' }}" style="width:100%;padding:6px;">
    </div>

    {% if edit_data %}
      <input type="hidden" name="edit_index" value="{{ request.args.get('edit') }}">
      <button type="submit" class="btn btn-primary">✏️ 수정 완료</button>
      <a href="{{ url_for('upload_lecture') }}" class="btn btn-secondary">취소</a>
    {% else %}
      <button type="submit" class="btn btn-success">📤 새 자료 업로드</button>
    {% endif %}
  </form>

  <hr>

  <h5>📂 업로드된 강의자료</h5>
  <table class="table table-bordered text-center mt-3">
    <thead>
      <tr>
        <th>번호</th>
        <th>내용</th>
        <th>자료파일</th>
        <th>연관사이트</th>
        <th>비고</th>
        <th>업로드시각</th>
        <th>수정</th>
        <th>삭제</th>
      </tr>
    </thead>
    <tbody>
      {% for row in data %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ row["내용(Topic)"] }}</td>
        <td>{{ row["자료파일(File URL)"] }}</td>
        <td>{{ row["연관사이트(Related Site)"] }}</td>
        <td>{{ row["비고(Notes)"] }}</td>
        <td>{{ row["업로드시각"] }}</td>
        <td><a href="{{ url_for('upload_lecture') }}?edit={{ loop.index0 }}" class="btn btn-sm btn-primary">수정</a></td>
        <td>
          <form method="POST">
            <input type="hidden" name="delete_row" value="{{ loop.index0 }}">
            <button type="submit" class="btn btn-sm btn-danger">삭제</button>
          </form>
        </td>
      </tr>
      {% else %}
        <tr><td colspan="8">등록된 강의자료가 없습니다.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

