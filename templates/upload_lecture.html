{% extends "base.html" %}
{% block content %}

<h3>📘 강의자료 업로드</h3>
<p>교수님은 강의자료를 업로드·수정·삭제할 수 있습니다.</p>

<form method="POST" action="{{ url_for('upload_lecture') }}">
  <label>① 내용(Topic)</label><br>
  <input type="text" name="topic" class="form-control" required><br>

  <!-- 파일 URL 동적 추가 영역 -->
  <label>② 자료파일 URL</label>
  <div id="fileInputs">
    <input type="text" name="file_url" placeholder="https://..." class="form-control mb-1">
  </div>
  <button type="button" class="btn btn-sm btn-outline-primary" onclick="addFileInput()">＋ 추가</button>
  <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeFileInput()">－ 삭제</button>
  <br><br>

  <!-- 연관 사이트 동적 추가 영역 -->
  <label>③ 연관 사이트 (Google Drive, 뉴스 등)</label>
  <div id="siteInputs">
    <input type="text" name="ref_site" placeholder="https://..." class="form-control mb-1">
  </div>
  <button type="button" class="btn btn-sm btn-outline-primary" onclick="addSiteInput()">＋ 추가</button>
  <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeSiteInput()">－ 삭제</button>
  <br><br>

  <label>④ 비고(Notes)</label><br>
  <input type="text" name="notes" class="form-control"><br>

  <button type="submit" class="btn btn-success">📤 새 자료 업로드</button>
</form>

<hr>
<h4>📚 업로드된 강의자료</h4>

<table class="table table-striped table-bordered">
  <thead class="table-dark">
    <tr>
      <th>번호</th>
      <th>내용</th>
      <th>자료파일</th>
      <th>연관사이트</th>
      <th>비고</th>
      <th>업로드시각</th>
      <th>수정</th>
      <th>삭제</th>
    </tr>
  </thead>
  <tbody>
    {% for row in data %}
    <tr>
      <td>{{ row["번호"] }}</td>
      <td>{{ row["내용"] }}</td>
      <td>{{ row["자료파일"] }}</td>
      <td>{{ row["연관사이트"] }}</td>
      <td>{{ row["비고"] }}</td>
      <td>{{ row["업로드시각"] }}</td>
      <td><a href="{{ url_for('edit', index=loop.index0) }}">수정</a></td>
      <td><a href="{{ url_for('delete', index=loop.index0) }}" onclick="return confirm('삭제하시겠습니까?')">삭제</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
// ──────────────
// 📂 자료파일 추가/삭제
// ──────────────
function addFileInput() {
  const div = document.createElement('div');
  div.innerHTML = `<input type="text" name="file_url" placeholder="https://..." class="form-control mb-1">`;
  document.getElementById('fileInputs').appendChild(div);
}
function removeFileInput() {
  const div = document.getElementById('fileInputs');
  if (div.children.length > 1) div.removeChild(div.lastChild);
}

// ──────────────
// 🌐 사이트 추가/삭제
// ──────────────
function addSiteInput() {
  const div = document.createElement('div');
  div.innerHTML = `<input type="text" name="ref_site" placeholder="https://..." class="form-control mb-1">`;
  document.getElementById('siteInputs').appendChild(div);
}
function removeSiteInput() {
  const div = document.getElementById('siteInputs');
  if (div.children.length > 1) div.removeChild(div.lastChild);
}
</script>

{% endblock %}
