
{% extends "base.html" %}
{% block content %}
<h3>ğŸ“˜ ê°•ì˜ìë£Œ ì—…ë¡œë“œ</h3>
<p>êµìˆ˜ë‹˜ì€ ê°•ì˜ìë£Œë¥¼ ì—…ë¡œë“œÂ·ìˆ˜ì •Â·ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<form method="POST" action="{{ url_for('upload_lecture') }}" enctype="multipart/form-data">
  <label>â‘  ë‚´ìš©(Topic)</label>
  <input type="text" name="topic" class="form-control mb-2" required>

  <label>â‘¡ ìë£ŒíŒŒì¼ ì„ íƒ</label>
  <input type="file" name="file" class="form-control mb-2" multiple>

  <label>â‘¢ ì—°ê´€ ì‚¬ì´íŠ¸ (Google Drive, ë‰´ìŠ¤ ë“±)</label>
  <div id="siteInputs">
    <input type="text" name="ref_site" placeholder="https://..." class="form-control mb-1">
  </div>
  <button type="button" class="btn btn-outline-primary btn-sm" onclick="addSiteInput()">ï¼‹ ì¶”ê°€</button>
  <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeSiteInput()">ï¼ ì‚­ì œ</button>
  <br><br>

  <label>â‘£ ë¹„ê³ (Notes)</label>
  <input type="text" name="notes" class="form-control mb-3">

  <button type="submit" class="btn btn-success">ğŸ“¤ ìƒˆ ìë£Œ ì—…ë¡œë“œ</button>
</form>

<hr>
<h4>ğŸ“š ì—…ë¡œë“œëœ ê°•ì˜ìë£Œ</h4>
<table class="table table-striped table-bordered">
  <thead class="table-dark">
    <tr>
      <th>ë²ˆí˜¸</th><th>ë‚´ìš©</th><th>ìë£ŒíŒŒì¼</th><th>ì—°ê´€ì‚¬ì´íŠ¸</th><th>ë¹„ê³ </th>
      {% if session.get('role') == 'professor' %}<th>ì—…ë¡œë“œì‹œê°</th>{% endif %}
    </tr>
  </thead>
  <tbody>
    {% for row in data %}
    <tr>
      <td>{{ row["ë²ˆí˜¸"] }}</td>
      <td>{{ row["ë‚´ìš©"] }}</td>
      <td>
        {% for f in row["ìë£ŒíŒŒì¼"].split(";") %}
          {% if f %}
          <a href="/download/{{ f.strip() }}">{{ f.strip() }}</a><br>
          {% endif %}
        {% endfor %}
      </td>
      <td>{{ row["ì—°ê´€ì‚¬ì´íŠ¸"] }}</td>
      <td>{{ row["ë¹„ê³ "] }}</td>
      {% if session.get('role') == 'professor' %}
      <td>{{ row["ì—…ë¡œë“œì‹œê°"] }}</td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
function addSiteInput() {
  const div = document.createElement('div');
  div.innerHTML = `<input type="text" name="ref_site" placeholder="https://..." class="form-control mb-1">`;
  document.getElementById('siteInputs').appendChild(div);
}
function removeSiteInput() {
  const div = document.getElementById('siteInputs');
  if (div.children.length > 1) div.removeChild(div.lastChild);
}
</script>
{% endblock %}
