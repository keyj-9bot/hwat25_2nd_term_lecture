{% extends "base.html" %}
{% block content %}

<h3 class="fw-bold mb-4 text-primary">ğŸ“¤ ê°•ì˜ìë£Œ ì—…ë¡œë“œ & ê²Œì‹œ ê´€ë¦¬</h3>

<!-- âœ… ê°•ì˜ìë£Œ ì—…ë¡œë“œ í¼ -->
<div class="card p-4 mb-4 shadow-sm">
  <h5 class="fw-bold mb-3">ìƒˆ ê°•ì˜ìë£Œ ì—…ë¡œë“œ</h5>
  <form method="POST" enctype="multipart/form-data">
    <div class="mb-3">
      <label class="form-label fw-bold">ğŸ“˜ ì œëª©</label>
      <input type="text" name="title" class="form-control" placeholder="ê°•ì˜ìë£Œ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
    </div>

    <div class="mb-3">
      <label class="form-label fw-bold">ğŸ“ ë‚´ìš©</label>
      <textarea name="content" rows="3" class="form-control" placeholder="ì„¤ëª…ì´ë‚˜ ì£¼ìš” ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label fw-bold">ğŸ”— ê´€ë ¨ ë§í¬</label>
      <input type="text" name="link1" class="form-control mb-1" placeholder="ë§í¬ 1 (ì„ íƒ)">
      <input type="text" name="link2" class="form-control mb-1" placeholder="ë§í¬ 2 (ì„ íƒ)">
      <input type="text" name="link3" class="form-control" placeholder="ë§í¬ 3 (ì„ íƒ)">
    </div>

    <div class="mb-3">
      <label class="form-label fw-bold">ğŸ“ íŒŒì¼ ì²¨ë¶€</label>
      <input type="file" name="files" class="form-control" multiple>
      <small class="text-muted">ì—¬ëŸ¬ íŒŒì¼ì„ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</small>
    </div>

    <button type="submit" class="btn btn-primary fw-bold">ìë£Œ ì—…ë¡œë“œ</button>
  </form>
</div>

<hr class="my-4">

<!-- âœ… ì—…ë¡œë“œëœ ìë£Œ ëª©ë¡ -->
<h5 class="fw-bold mb-3 text-secondary">ğŸ“‚ ì—…ë¡œë“œëœ ìë£Œ ëª©ë¡</h5>

{% if lectures and lectures|length > 0 %}
  {% for lec in lectures %}
  <div class="border rounded p-3 mb-3 bg-light shadow-sm">
    <div class="d-flex justify-content-between align-items-center">
      <h6 class="fw-bold text-primary mb-1">{{ lec.title or 'ì œëª© ì—†ìŒ' }}</h6>
      <small class="text-muted">{{ lec.date }}</small>
    </div>
    <p class="mb-2">{{ lec.content or '' }}</p>

    {% if lec.files %}
      <p class="mb-1">ğŸ“ <b>ì²¨ë¶€ íŒŒì¼:</b>
        {% for f in (lec.files or '').split(';') if f.strip() %}
          <a href="{{ url_for('uploaded_file', filename=f.strip()) }}" target="_blank" class="text-decoration-none">{{ f.strip() }}</a>{% if not loop.last %}, {% endif %}
        {% endfor %}
      </p>
    {% endif %}

    {% if lec.links %}
      <p class="mb-1">ğŸ”— <b>ê´€ë ¨ ë§í¬:</b>
        {% for l in (lec.links or '').split(';') if l.strip() %}
          <a href="{{ l.strip() }}" target="_blank" class="text-decoration-none text-success">{{ l.strip() }}</a>{% if not loop.last %}, {% endif %}
        {% endfor %}
      </p>
    {% endif %}

    <div class="d-flex justify-content-between align-items-center mt-2">
      <small class="text-muted">
        {% if lec.confirmed == "yes" %}
          âœ… ê²Œì‹œ í™•ì •ë¨
        {% else %}
          â³ ë¯¸ê²Œì‹œ
        {% endif %}
      </small>
      <div>
        {% if lec.confirmed != "yes" %}
          <!-- ê²Œì‹œ í™•ì • ë²„íŠ¼ -->
          <form method="POST" action="{{ url_for('confirm_lecture', index=loop.index0) }}" class="d-inline">
            <button type="submit" class="btn btn-sm btn-outline-success">ê²Œì‹œ í™•ì •</button>
          </form>
        {% endif %}

        <!-- ì—…ë¡œë“œ ì‚­ì œ -->
        <form method="POST" action="{{ url_for('delete_lecture', index=loop.index0) }}" class="d-inline">
          <button type="submit" class="btn btn-sm btn-outline-danger">ì‚­ì œ</button>
        </form>
      </div>
    </div>
  </div>
  {% endfor %}
{% else %}
  <p class="text-muted">ì•„ì§ ì—…ë¡œë“œëœ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
{% endif %}

{% endblock %}
