{% extends "base.html" %}
{% block content %}
<h3 class="mb-4">📘 학습 사이트</h3>

<!-- 질문 등록 -->
<form method="POST" class="mb-4">
  <input type="text" name="title" class="form-control mb-2" placeholder="질문 제목" required>
  <textarea name="content" class="form-control mb-2" placeholder="질문 내용" required></textarea>
  <button type="submit" class="btn btn-success">질문 등록</button>
</form>

<hr>

<!-- 질문 목록 -->
{% for q in questions %}
<div class="card mb-3">
  <div class="card-body">
    <h5>{{ q.title }}</h5>
    <p>{{ q.content }}</p>
    <small>작성자: {{ q.email }} | {{ q.date }}</small>

    {% if is_prof %}
    <a href="{{ url_for('delete_question', question_id=q.id) }}" class="btn btn-danger btn-sm float-end ms-2">질문삭제</a>
    {% endif %}

    <hr>
    <h6>💬 댓글</h6>

    {% for c in comments %}
      {% if c.question_id == q.id %}
        <div class="ms-3 mb-2">
          <p>{{ c.comment }}</p>
          <small>작성자: {{ c.email }} | {{ c.date }}</small>
          {% if is_prof %}
          <a href="{{ url_for('delete_comment', comment_index=loop.index0) }}" class="btn btn-outline-danger btn-sm ms-2">댓글삭제</a>
          {% endif %}
        </div>
      {% endif %}
    {% endfor %}

    <form method="POST" action="{{ url_for('add_comment', question_id=q.id) }}" class="mt-2">
      <input type="text" name="comment" class="form-control mb-2" placeholder="댓글 입력" required>
      <button type="submit" class="btn btn-outline-primary btn-sm">댓글 등록</button>
    </form>
  </div>
</div>
{% endfor %}

<hr class="my-5">

<!-- 📚 강의자료 게시판 -->
<h4>📚 강의자료 게시판</h4>
{% if lectures %}
  {% for lec in lectures %}
  <div class="card mb-3">
    <div class="card-body">
      <h5>{{ lec.title }}</h5>
      <p>{{ lec.content }}</p>
      {% if lec.files %}
        {% for f in lec.files.split(";") %}
          <a href="{{ url_for('uploaded_file', filename=f) }}" target="_blank" class="d-block text-decoration-none">📎 {{ f }}</a>
        {% endfor %}
      {% endif %}
      {% if lec.links %}
        {% for l in lec.links.split(";") %}
          <a href="{{ l }}" target="_blank" class="d-block">🔗 {{ l }}</a>
        {% endfor %}
      {% endif %}
      <p class="text-muted small mt-2">업로드: {{ lec.date }}</p>
    </div>
  </div>
  {% endfor %}
{% else %}
  <p class="text-muted">등록된 강의자료가 없습니다.</p>
{% endif %}
{% endblock %}



