{% extends "base.html" %}
{% block content %}
<div class="container mt-4">

  <h3>📘 강의자료 목록</h3>
  <table class="table table-striped table-bordered text-center align-middle">
    <thead class="table-primary">
      <tr>
        <th>#</th>
        <th>내용(Topic)</th>
        <th>자료파일(File URL)</th>
        <th>연관사이트(Related Site)</th>
        <th>비고(Notes)</th>
        <th>업로드시각</th>
      </tr>
    </thead>
    <tbody>
      {% for row in data %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ row["내용(Topic)"] }}</td>
        <td>
          {% for f in row["자료파일(File URL)"].split(';') %}
            {% if f.strip() %}
              <a href="{{ f.strip() }}" target="_blank">{{ f.strip().split('/')[-1] }}</a><br>
            {% endif %}
          {% endfor %}
        </td>
        <td>
          {% for s in row["연관사이트(Related Site)"].split(';') %}
            {% if s.strip() %}
              <a href="{{ s.strip() }}" target="_blank">{{ s.strip() }}</a><br>
            {% endif %}
          {% endfor %}
        </td>
        <td>{{ row["비고(Notes)"] }}</td>
        <td>{{ row["업로드시각"] }}</td>
      </tr>
      {% else %}
      <tr><td colspan="6">등록된 강의자료가 없습니다.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <hr class="my-4">

  <!-- 💬 학생 Q&A -->
  <section style="background:#f8f9fa;padding:20px;border-radius:12px;">
    <h4>💬 학생 질문 게시판 
      <small class="text-muted">(비밀번호 4자리)</small>
    </h4>

    <!-- 질문 등록 -->
    <form method="POST" onsubmit="return validateStudentForm();" class="mb-4">
      <input type="hidden" name="action" value="add_qna">
      <div class="d-flex gap-2">
        <input type="text" name="name" placeholder="이름(선택)" style="width:20%;padding:6px;">
        <input type="text" name="question" placeholder="질문을 입력하세요" style="width:55%;padding:6px;" required>
        <input type="password" name="password" maxlength="4" placeholder="비밀번호(4자리)" style="width:15%;padding:6px;" required>
        <button type="submit" class="btn btn-primary" style="width:10%;">등록</button>
      </div>
    </form>

    <!-- 질문 목록 -->
    {% for item in qna %}
    <div style="background:white;border:1px solid #ddd;border-radius:10px;padding:15px;margin-bottom:18px;">
      <b>Q. {{ item["질문"] }}</b><br>
      <small class="text-muted">({{ item["이름"] }}, {{ item["등록시각"] }})</small>

      <form method="POST" class="mt-2 mb-2" onsubmit="return confirm('정말 삭제하시겠습니까?');">
        <input type="hidden" name="action" value="delete_qna">
        <input type="hidden" name="index" value="{{ loop.index0 }}">
        <input type="password" name="password" maxlength="4" placeholder="비밀번호 입력" style="width:150px;padding:4px;">
        <button type="submit" class="btn btn-outline-danger btn-sm">삭제</button>
      </form>
    </div>
    {% else %}
      <p style="color:#888;">등록된 질문이 없습니다.</p>
    {% endfor %}
  </section>
</div>
{% endblock %}
