
{% extends "base.html" %}
{% block content %}

<h3 class="fw-bold mb-4">ğŸ“˜ ê°•ì˜ìë£Œ ëª©ë¡</h3>

{% if lectures %}
<table class="table table-bordered text-center align-middle">
  <thead class="table-primary">
    <tr><th>ì œëª©</th><th>ë‚´ìš©</th><th>íŒŒì¼</th><th>ì‚¬ì´íŠ¸</th><th>ì—…ë¡œë“œì‹œê°</th></tr>
  </thead>
  <tbody>
    {% for lec in lectures %}
    <tr>
      <td>{{ lec.title }}</td>
      <td>{{ lec.content }}</td>
      <td>{% if lec.file_link %}<a href="{{ lec.file_link }}" target="_blank">ğŸ“‚</a>{% endif %}</td>
      <td>{% if lec.site_link %}<a href="{{ lec.site_link }}" target="_blank">ğŸŒ</a>{% endif %}</td>
      <td>{{ lec.uploaded_at if session.get('professor') else 'ë¹„ê³µê°œ' }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

<hr class="my-4">
<h4>ğŸ’¬ ì§ˆë¬¸ ë“±ë¡</h4>

<form method="POST">
  <textarea name="new_question" class="form-control mb-2" rows="3" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea>
  <input type="password" name="new_password" class="form-control mb-2" placeholder="ë¹„ë°€ë²ˆí˜¸ (ì§ˆë¬¸ ìˆ˜ì •Â·ì‚­ì œìš©)" required>
  <button type="submit" class="btn btn-success w-100">ë“±ë¡</button>
</form>

<hr class="my-4">
<h4>ğŸ—’ï¸ ì§ˆë¬¸ ëª©ë¡ ë° ëŒ“ê¸€</h4>

{% for q in questions %}
<div class="card mb-3">
  <div class="card-body">
    <h6 class="text-muted">{{ q.email }} ({{ q.created_at }})</h6>
    <p>{{ q.question }}</p>

    <!-- ìˆ˜ì • -->
    <form method="POST" class="mt-2">
      <input type="hidden" name="qid" value="{{ q.id }}">
      <input type="password" name="password" class="form-control mb-1" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
      <textarea name="edit_question" class="form-control mb-2" placeholder="ìˆ˜ì •í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
      <button class="btn btn-outline-warning btn-sm">ìˆ˜ì •</button>
    </form>

    <!-- ì‚­ì œ -->
    <form method="POST" class="mt-1">
      <input type="hidden" name="qid" value="{{ q.id }}">
      <input type="password" name="password" class="form-control mb-2" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
      <button class="btn btn-outline-danger btn-sm" name="delete_question">ì‚­ì œ</button>
    </form>

    <hr>
    <!-- ëŒ“ê¸€ ë“±ë¡ -->
    <form method="POST" class="d-flex mb-2">
      <input type="hidden" name="qid" value="{{ q.id }}">
      <input type="text" name="new_comment" class="form-control me-2" placeholder="ëŒ“ê¸€ ì…ë ¥" required>
      <input type="password" name="comment_pw" class="form-control me-2" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
      <button class="btn btn-outline-primary">ë“±ë¡</button>
    </form>

    <!-- ëŒ“ê¸€ ëª©ë¡ -->
    {% for c in comments if c.qid == q.id %}
    <div class="ms-3 text-secondary border-start ps-2 mb-2">
      â†³ <b>{{ c.email }}</b>: {{ c.comment }} ({{ c.created_at }})
      <form method="POST" class="d-flex mt-1">
        <input type="hidden" name="cid" value="{{ c.cid }}">
        <input type="password" name="password" class="form-control form-control-sm me-2" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" required>
        <button class="btn btn-sm btn-outline-danger" name="delete_comment">ì‚­ì œ</button>
      </form>
    </div>
    {% endfor %}
  </div>
</div>
{% endfor %}
{% endblock %}
