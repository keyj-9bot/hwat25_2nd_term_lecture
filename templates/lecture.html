{% extends "base.html" %}
{% block content %}
<div class="container mt-4">

  <h3>ğŸ“˜ ê°•ì˜ìë£Œ ëª©ë¡</h3>
  <table class="table table-striped table-bordered text-center align-middle">
    <thead class="table-primary">
      <tr>
        <th>#</th>
        <th>ë‚´ìš©(Topic)</th>
        <th>ìë£ŒíŒŒì¼(File URL)</th>
        <th>ì—°ê´€ì‚¬ì´íŠ¸(Related Site)</th>
        <th>ë¹„ê³ (Notes)</th>
        <th>ì—…ë¡œë“œì‹œê°</th>
      </tr>
    </thead>
    <tbody>
      {% for row in data %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ row["ë‚´ìš©(Topic)"] }}</td>
        <td>
          {% for f in row["ìë£ŒíŒŒì¼(File URL)"].split(';') %}
            {% if f.strip() %}
              <a href="{{ f.strip() }}" target="_blank">{{ f.strip().split('/')[-1] }}</a><br>
            {% endif %}
          {% endfor %}
        </td>
        <td>
          {% for s in row["ì—°ê´€ì‚¬ì´íŠ¸(Related Site)"].split(';') %}
            {% if s.strip() %}
              <a href="{{ s.strip() }}" target="_blank">{{ s.strip() }}</a><br>
            {% endif %}
          {% endfor %}
        </td>
        <td>{{ row["ë¹„ê³ (Notes)"] }}</td>
        <td>{{ row["ì—…ë¡œë“œì‹œê°"] }}</td>
      </tr>
      {% else %}
      <tr><td colspan="6">ë“±ë¡ëœ ê°•ì˜ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <hr class="my-4">

  <!-- ğŸ’¬ í•™ìƒ Q&A -->
  <section style="background:#f8f9fa;padding:20px;border-radius:12px;">
    <h4>ğŸ’¬ í•™ìƒ ì§ˆë¬¸ ê²Œì‹œíŒ 
      <small class="text-muted">(ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬)</small>
    </h4>

    <!-- ì§ˆë¬¸ ë“±ë¡ -->
    <form method="POST" onsubmit="return validateStudentForm();" class="mb-4">
      <input type="hidden" name="action" value="add_qna">
      <div class="d-flex gap-2">
        <input type="text" name="name" placeholder="ì´ë¦„(ì„ íƒ)" style="width:20%;padding:6px;">
        <input type="text" name="question" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”" style="width:55%;padding:6px;" required>
        <input type="password" name="password" maxlength="4" placeholder="ë¹„ë°€ë²ˆí˜¸(4ìë¦¬)" style="width:15%;padding:6px;" required>
        <button type="submit" class="btn btn-primary" style="width:10%;">ë“±ë¡</button>
      </div>
    </form>

    <!-- ì§ˆë¬¸ ëª©ë¡ -->
    {% for item in qna %}
    <div style="background:white;border:1px solid #ddd;border-radius:10px;padding:15px;margin-bottom:18px;">
      <b>Q. {{ item["ì§ˆë¬¸"] }}</b><br>
      <small class="text-muted">({{ item["ì´ë¦„"] }}, {{ item["ë“±ë¡ì‹œê°"] }})</small>

      <form method="POST" class="mt-2 mb-2" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
        <input type="hidden" name="action" value="delete_qna">
        <input type="hidden" name="index" value="{{ loop.index0 }}">
        <input type="password" name="password" maxlength="4" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" style="width:150px;padding:4px;">
        <button type="submit" class="btn btn-outline-danger btn-sm">ì‚­ì œ</button>
      </form>
    </div>
    {% else %}
      <p style="color:#888;">ë“±ë¡ëœ ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endfor %}
  </section>
</div>
{% endblock %}
